# UR4Rec V2 - RETRIEVER FOCUSED
# 专门优化retriever以达到从0.3到0.8的提升目标

# Dataset settings
num_items: 1682
max_seq_len: 50

# SASRec parameters - 保持简单以便retriever主导
sasrec_hidden_dim: 128
sasrec_num_blocks: 2
sasrec_num_heads: 4
sasrec_dropout: 0.2

# Text encoder parameters
text_model_name: "all-MiniLM-L6-v2"
text_embedding_dim: 384
retriever_output_dim: 256

# MoE parameters
moe_num_heads: 8
moe_dropout: 0.2
moe_num_proxies: 4

# Memory mechanism parameters
max_memory_size: 20
update_trigger: "INTERACTION_COUNT"
interaction_threshold: 5
drift_threshold: 0.3
decay_factor: 0.95

# Fusion parameters - **关键改动：让retriever主导**
fusion_method: "weighted"
sasrec_weight: 0.3  # 降低SASRec权重
retriever_weight: 0.7  # 大幅提高retriever权重

# Training parameters
sasrec_lr: 0.001
retriever_lr: 0.005  # 提高retriever学习率
use_uncertainty_weighting: false
use_adaptive_alternating: false
adaptive_switch_threshold: 0.01
adaptive_min_steps: 5

# Training stages - **关键：先训练retriever**
stages:
  - pretrain_retriever  # 第一步：单独训练retriever
  - pretrain_sasrec     # 第二步：训练SASRec
  - joint_finetune      # 第三步：联合微调

epochs_per_stage: 50
patience: 15

# Other settings
batch_size: 16
num_workers: 4
seed: 42
num_negatives: 20
